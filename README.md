# pbl-learning-platform
A course project for Advanced Web Technologies at FDU. 

*希望大嘎顺手学一下Markdown，基础使用超简单*

*可用资源包括但不限于[菜鸟教程](https://www.runoob.com/markdown/md-tutorial.html)*

***推荐可以使用[Typora](https://typora.io/)进行编写，工具干净好用跨平台***



## 按页面分类的功能、UI设计

> 设置一个侧边栏或者导航栏，可以快速导向各种界面，没有权限的用户不应当出现该页面的标签。

### 登录页面

1. 学生和教师以及管理员的登录功能，对于基本的输入正确性检测（是否有输入，正确性校验，**密码不应当明文传输**）
   
2. 登录成功后跳转应当去往不同页面
   
    - 学生 + 教师：课程页面
    
    - 管理员：用户管理页面
    
3. 登录页面要有通向注册页面的路由

### 注册页面

1. 学生的注册功能，对于基本的输入正确性检测
   
   - 学号，必须，合法性（长度是否满足、只能输入数字）、重复性校验（是否和数据库中已经有的用户重复）
   - 姓名，必须，合法性（别过长，可以限定不要有特殊字符）
   - 性别，单选框（男、女、不愿透露）
   - 密码，必须，合法性（数字、字母、特殊字符（_、*）组合，八位及以上）
   - 确认密码，必须，合法性（和密码输入一致）
   - 头像可以不用这个时候上传，可以直接给个默认的，到后面想完善的再完善好了
   - 个人简介也是，后面再补充，这样比较友好，否则注册过程太冗长
   
2. 注册成功后有两种方案，一种是直接默认登录成功，跳转到个人信息界面，另一种是需要再次登录，跳转到登录界面

   > 具体实现的时候可以自由选择哪种方式，需要跳往的页面与登录后跳转的页面一致即可

### 个人信息管理、展示页面

1. 对个人信息的展示，不同身份的用户展示的形式应该是不同的

    - 简单来看，教师和学生的个人信息展示应该是一样的，包括：
      - 头像
      - 姓名
      - 学工号
      - 性别
      - 个人简介
      - 我修/教的课（可以选择仅自己可见，功能上比较人性化，但是管理员应该啥都能看到）
    
    - 管理员的个人信息展示：展示内容和学生、教师相同，只是少了我修/教的课
    
2. 对个人信息的修改

    - 学工号不允许修改
    - 可以解锁table变成input框以便修改数据，同时出现提交和取消两个按钮，点击提交进行校验，而后修改
    - 修改密码需要**在修改状态下**显示一个特别的按键，可以有单独的弹窗，需要输入老密码、新密码、确认密码，需要校验

3. 对个人信息的删除

   - 实现了修改也就实现了删除。
   
4. 上传头像功能（是否压缩，作为附加功能）

    - 头像可以有单独的上传新头像按键，也可以有恢复默认头像按键

      可以配合个人信息修改，**点击解锁修改了之后才显示这两个按键**。


### 课程管理页面

1. 课程为一个个card排列，展示内容为课程名称、课程简介、教师、学分、~~学时~~、以某种形式展示课程是否已经发布（例如有一个蓝色的badge的是已发布，灰色的是未发布，红色的是已删除）

    - 教师看到的分为`我教的课`、`其它课程`
      - 我教的课分为未发布和已发布和已删除，各自有两个按键
        - 未发布课程有修改和发布按键，修改实现可以参考个人信息修改
        - 已发布课程有禁用的修改按键和可用的删除按键（后台把状态改为已删除，学生无法看到所有相关信息，教师仍旧可以看到这个项）
        - 已删除课程有禁用的修改按键和可用的恢复按键（恢复后状态变为已发布，学生可以正常查看）
        - 要有添加新课程的按键，默认填充教师为本人
      - 其它课程有禁用的修改和删除按键，不能进入其它课程的项目管理页面
        - 未发布课程不可见

    - 学生看到的分为`我修的课`、`其它课程`
      - 其它课程显示加入按键，不能进入其它课程的项目管理页面

      - 未发布课程不可见

    - 管理员所有课程，包括未发布，都能看，且能够进入项目管理页面

2. 可以通过点击具体课程名称跳转到具体课程的项目管理界面，换言之，课程名称为一个链接


### 项目管理页面（下辖多个页面）

#### 项目展示页面

1. 展示某课程所有项目（学生可以加入，后查看详情；老师可以查看、添加、删除项目）

    - 项目以卡片形式展示，不同用户有不同按钮，不展示已删除状态的项目

      - 学生：未加入的项目有加入按钮，已经加入的项目可以查看详情，查看讨论版，查看文件管理空间，不可以退出项目

      - 老师：所有项目均有查看详情、查看讨论版、查看文件管理空间、删除按钮，（删除之后修改项目状态为已删除，不可恢复）

        - 还有一个添加项目的按钮（可以作为一个大的加号card的形式），点击以后弹出创建项目的对话框，包含
    - 项目名称
          - 所属课程（仅展示，不可修改）
              - 项目简介
              - 评分规则
            - 教师评分占比，必选，仅展示占比，默认为100%，如果勾选了自评和互评，就等于100%-自评占比-互评占比
              - 后端获取教师占比之后，拆分为两半，给到任务完成占比和讨论版发言占比
            - 是否允许自评，是的话，填充占比
            - 是否允许互评，是的话，填充占比
            - 校验：最多全选，自评互评之和不能大于100%

#### 项目详情页面

可以分为四个标签页

- 任务页面
- 成员页面
- 讨论版页面
- 文件管理空间页面

##### 任务页面

1. 默认以Card形式展示所有任务，内容包括：

    - 任务名称
    - 开始日期、截至日期
    - 重要程度
    - 完成情况（可以用badge表示，分为已完成、未完成），同学可以点击按钮表示已经完成任务，点击后badge变色，按钮disable
    - 组长、老师增加显示全项目完成情况（xx/XX人已完成）
    - 添加任务、删除任务按键、督促完成任务按键（老师、组长有，点击后所有未完成的同学下次进入任务页面时收到提示）
    - 所有内容老师、组长可修改

2. 任务页面可以点击某个开关转换为甘特图形式展示

    - 每一行为一个任务，左侧展示任务名和完成情况（组长、老师增加显示全项目完成情况），右侧表示项目时间跨度
    - 老师、组长可修改任务内容，可添加、删除任务、督促任务
    - 甘特图中任务颜色可以按照重要程度变化

##### 成员页面

1. 包含：

    - 成员学号
    - 姓名（点击应当能跳转到个人信息展示页面）
    - 评分（默认锁定，根据项目的自评、互评是否在数据库中占比不为null来解锁，可以一次性填完后提交）

##### 讨论版页面

1. 按最近回复时间从近到远显示每个帖子，每个帖子可以展示最新的两条回复（简单起见，也可以不展示）
   - 帖子包含主题、发起人、内容、时间
   - 帖子有回复按钮，点击可以展示出一个文本框进行回复
   - 发起人能够删除自己的帖子
2. 点击一个按键可以展开某个帖子，按照从远到近的时间查看所有回复
   - 回复包含回复人、内容、时间
   - 回复要能被回复，简单起见，可以点击回复以后直接在弹出的文本框里添加“回复某某：”为开头
   - 回复人能删除自己的回复

##### 文件管理空间页面

1. 有上传按键，点击应当弹出对话框，填充文件名、上传文件
2. 文件一行行展示，有文件名、上传人、下载按钮
3. 上传人和老师和管理员可以删除文件

### 评分页面

1. 教师可以从下拉框选择自己教的课程、选择课程中的项目，对其中参与的学生进行评分。
   
   - 展示一个表格，每一行为一个学生，每一列为参与评分的模块，包括：
     - 任务完成数
     - 任务完成得分，按比例，分数=100*（学生完成数 / 任务总数）
     - 讨论版发言数
     - 讨论版得分，按比例，分数=100*（学生发言数 / 最高单人发言数）
     - 自评分
     - 互评分
     - 教师加分（输入）
     - 总分（生成）
     
   - 要有一个提交的按键，提交评分后不再变动
   - Better：表格应当能按照每列分别排序，应该有组件能实现该功能
   
2. 学生可以从下拉框中选择自己学的课程、选择课程中的项目，查看

   - 该项目中每个模块的分数占比，可以在表头中、该模块名边上括号标注（占XX%）
   - 自己在该项目中的得分，包括：
     - 任务完成数
     - 任务完成得分，按比例，分数=100*（学生完成数 / 任务总数）
     - 讨论版发言数
     - 讨论版得分，按比例，分数=100*（学生发言数 / 最高单人发言数）
     - 自评分
     - 互评分
     - 教师加分（输入）
     - 总分（生成）
   - 如果评分未提交，学生可以预览预估自己的分数；如果已提交，学生查看最终得分；学生要被告知当前分数是否已经确定

3. 学生可以和同学间进行互评、自评。互评、自评在项目人员页面可以完成（如有）。


### 用户管理页面

1. 管理员可以看到这个页面
2. 显示所有用户列表，包括
   - 学工号
   - 姓名（点击可以跳到个人信息展示页面，那个页面中管理员有权限修改所有数据）
   - 用户身份
   - 解锁修改的按钮，但不能修改用户身份
   - 删除用户的按钮
     - 删除之后改变用户的状态为已删除，之后该用户无法登陆，但该用户的记录仍旧存在，只是点击该用户姓名进入详情页后显示用户已删除的默认空信息
     - 被删除用户不参与评分
3. 可以添加用户，填充
   - 学工号
   - 姓名
   - 性别（三选一）
   - 用户身份（三选一）
   - 密码
   - 确认密码




## 数据库设计
- user (<u>u_id</u>, type, u_name, gender, password, description, image)  

  - image为布尔值，true表示已经上传头像，名称为u_id.jpg；false表示使用默认头像
  
- course (<u>c_id</u>, t_id, c_name, point, ~~class_time~~, description, status,image_URL)  

  - status: 未发布(0)，已发布(1)，已删除(-1)
  - t_id是课程教师，reference u_id@user, type=teacher
  - image_URL为课程封面URL
  
- project (<u>p_id</u>, c_id, p_name, description, grading_status,teacher_grade_ratio, self_grade_ratio, mutual_grade_ratio)  

  - grading_status: 未评分，已评分
  
  - c_id是所属的课程，reference c_id@course
  
  - teacher_grade_ratio为教师评分占比
  
  - self_grade_ratio, mutual_grade_ratio 可以为null，表示不开启自评、互评，不为null则表示评分占比
  
- grade_system(<u>p_id</u>,<u>item_id</u>,description,max_grade) 

  - p_id是项目id，reference p_id@project

  - item_id是每个评分细则的id
  - description是对每个评分细则的描述
  - max_grade是每个评分细则的最大得分上限

- assignment (<u>a_id</u>, <u>p_id</u>, ~~s_id,~~ a_name, a_description, importance, a_start_date, a_end_date, ~~a_status, urge~~)  

- student_grade(<u>s_id</u>,<u>p_id</u>,<u>item_id</u>,grade)

  - s_id是同学，p_id为项目id，reference (s_id, p_id)@student_project
  - item_id为评分细则的id，reference item_id@grade_system
  - grade为评分，每个评分不能超过grade_system中的max_grade

- student_assignment (<u>a_id</u>, <u>p_id</u>, <u>s_id</u>, status, urge)
  - a_id是任务，p_id是所属于的项目，reference (a_id, p_id)@assignment
  - s_id是同学，reference (s_id, p_id)@student_project
  - status是任务完成情况，默认false
  - urge是布尔值，表示目前该任务有没有被催促，默认false，学生进入项目详情页面时会根据该值弹出提示的催促尽快完成信息
  - 每个同学加入一个项目时，后端需要检索该项目所有任务，每个任务都添加一行到该表中
  - 每当组长、老师增加新任务时，所有在项目中的同学都要增加一行到该表中，删除时也要全部删除
  - 组长、老师督促某个任务时，所有相关任务未完成的同学的urge被改为true，阅读一次后改回false
  
- student_course (<u>s_id</u>, <u>c_id</u>)  

  - s_id是被分配的同学，reference u_id@user, type=student
  
- student_project (<u>s_id</u>, <u>p_id</u>, is_group_leader, self_grade, mutual_grade, teacher_grade)  

  - is_group_leader表示是否为leader，还是只是组员
  - s_id是同学，reference u_id@user, type=student
  - p_id是项目，reference p_id@project
  - self_grade, mutual_grade, teacher_grade
    - 默认为0，取数据时要考虑project表中是否评分状态为已评分，如果未评分需要自行计算数据，如果已评分则写入该表，通过该表查询
    - 总分需要去project表中查询占比，然后与这里的分数做加权平均得到
  
- discussion (<u>d_id</u>, p_id, u_id, content, time)
  - p_id是所属于的项目，reference p_id@project
  - u_id是老师或者学生，reference u_id@user, type=student || teacher
  
- reply (<u>r_id</u>, d_id, u_id, content, time)
  - 讨论版数据（每个project有一个讨论版，讨论版可以有好多帖子，每个帖子包含发帖人、主题、内容、时间戳；每个帖子有好多回复，每个回复有回复人、时间戳）
  - u_id是老师或者学生，reference u_id@user, type=student || teacher
  - d_id是某个帖子的id，reference d_id@discussion
  
- file (<u>f_id</u>, <u>p_id</u>, u_id, f_name, description, file_URL)

  - f_name保留原有上传时的文件名
  - fileURL根据f_id和p_id生成
  - p_id是项目，reference p_id@project
  - u_id是老师或者学生，reference u_id@user, type=student || teacher
  
- evaluation (<u>p_id</u>, <u>active\_s_id</u>, <u>passive\_s_id</u>, grade)

  - p_id是项目，reference p_id@project
  - 两个s_id是同学，reference u_id@user, type=student
  - 如果两个s_id相同，表明是自评，不同则是互评
  - 如果来查询自评、互评成绩时还没有评分过，后端应该手动返回未评分而非null
  - 可以通过后端返回count和sum的形式完成要求，count是0前端就明白还没有人评分
  




## 按页面分类的接口设计（请求URL、输入、输出）

> 待完善，或许URL前面能写/api/url，例如/api/login，这样可以避免跟真实页面的请求路径冲突

### 登录页面

接口URL：/account/login

请求方法：POST

请求参数：

|  字段名  |         说明         |  类型  | 是否必填 |   备注    |
| :------: | :------------------: | :----: | :------: | :-------: |
|   u_id   | 学号/工号/管理员编号 | String |    是    |     -     |
| password |         密码         | String |    是    | md5码加密 |

返回参数：

| 字段名  | 说明                                                       |  类型  |                             备注                             |
| :-----: | :--------------------------------------------------------- | :----: | :----------------------------------------------------------: |
|  code   | 200：登录成功<br>208：用户id不存在<br>209：密码错误        |  int   |                              -                               |
| message | 200时：携带token<br>208时：用户id不存在<br>209时：密码错误 | String | 在请求/api/login，/api/register和/api/searchId以外的api时需要以pbl_token的名字携带于header中以做身份校验，用户登录超过2个小时则状态失效<br>token设计：u_id+毫秒数+密码md5码后5位<br>例子：12345_5000_AB2DC |
|  user   | json序列化的User对象                                       | String |    User对象的属性有u_id,type, u_name, gender,description     |
|  image  | 200时：携带图像url<br>其它时：null                         | String |                              -                               |



### 注册页面

接口URL：/account/searchId

请求方法：GET

请求参数：

| 字段名 | 说明 | 类型 | 是否必填 | 备注 |
| :----: | :--: | :--: | :------: | :--: |
|  u_id  | 学号 | int  |    是    |  -   |

返回参数：

| 字段名 | 说明                             | 类型 | 备注 |
| :----: | :------------------------------- | :--: | :--: |
|  code  | 200：学号可用<br>208：学号已存在 | int  |  -   |



接口URL：/account/register

请求方法：POST

请求参数：

|   字段名    | 说明 |     类型      | 是否必填 |        备注        |
| :---------: | :--: | :-----------: | :------: | :----------------: |
|    u_id     | 学号 |    String     |    是    |   类似S001、S002   |
|   u_name    | 姓名 |    String     |    是    |         -          |
|   gender    | 性别 |    String     |    是    |      男/女/无      |
|  password   | 密码 |    String     |    是    |     md5码加密      |
|    image    | 头像 | MultipartFile |    否    | 没有则生成默认头像 |
| description | 描述 |    String     |    否    |         -          |

返回参数：

| 字段名  | 说明                                     |  类型  |                             备注                             |
| :-----: | :--------------------------------------- | :----: | :----------------------------------------------------------: |
|  code   | 200：注册成功<br>其它：用户名已存在      |  int   |                              -                               |
| message | 200时：携带token<br>其它时：返回错误信息 | String | 在请求/api/login，/api/register和/api/searchId以外的api时需要以pbl_token的名字携带于header中以做身份校验 |
|  user   | json序列化的User对象                     | String |     User对象属性有u_id,type, u_name, gender,description      |
|  image  | 0时：携带图像url<br>其它时：null         | String |                              -                               |

### 个人信息管理、展示页面

接口URL：/api/searchMyCourses

请求方法：GET

请求参数：

|  字段名   | 说明 |  类型  | 是否必填 |     备注     |
| :-------: | :--: | :----: | :------: | :----------: |
| pbl_token |  -   | String |    是    | 用于验证身份 |
| pageIndex | 当前请求页码 |  String  |    是    |          -           |
| pageSize  | 一页元素数量 |  String  |    是    | 用于计算返回哪些元素 |

返回参数：

| 字段名  | 说明                                 |  类型  |                             备注                             |
| :-----: | :----------------------------------- | :----: | :----------------------------------------------------------: |
|  code   | 200：查询成功<br>208：登录超时       |  int   |                              -                               |
| message | 200：无<br>208：登录超时，请重新登录 | String |                              -                               |
| courses | json序列化course数组                 | String | course对象包含属性c_id,t_id,c_name,point, description, status,image_URL<br>这里包含了老师教的课程/学生选的课程 |
| teachers | json序列化user数组                   | String |          至少包含u_id, image, 再加其它字段也可以的           |
|  total   | 课程对象总数量                       |  int   |                        用于计算总页码                        |



接口URL：/api/searchMyInformation

请求方法：GET

请求参数：

|  字段名   | 说明 |  类型  | 是否必填 |        备注        |
| :-------: | :--: | :----: | :------: | :----------------: |
| pbl_token |  -   | String |    是    |    用于验证身份    |
|   u_id    |  -   | String |    是    | 用于确认是谁的信息 |

返回参数：

| 字段名  | 说明                                  |  类型  |                    备注                     |
| :-----: | :------------------------------------ | :----: | :-----------------------------------------: |
|  code   | 200：查询成功<br>208：登录超时        |  int   |                      -                      |
| message | 200：无<br>208：登录超时，请重新登录  | String |                      -                      |
| content | json序列化的User信息                  | String | 属性有u_id,type, u_name, gender,description |
|  image  | 200：携带图像url<br>208/209：空字符串 | String |                      -                      |



接口URL：/api/changeMyImage

请求方法：PUT

请求参数：

|  字段名   | 说明 |     类型      | 是否必填 |          备注          |
| :-------: | :--: | :-----------: | :------: | :--------------------: |
| pbl_token |  -   |    String     |    是    |      用于验证身份      |
|   u_id    |  -   |    String     |    是    | 用于指定修改头像的对象 |
|   image   | 头像 | MultipartFile |    否    |   无则修改为默认头像   |

返回参数：

| 字段名  | 说明                                 |  类型  | 备注 |
| :-----: | :----------------------------------- | :----: | :--: |
|  code   | 200：修改成功<br>208：登录超时       |  int   |  -   |
| message | 200：无<br>208：登录超时，请重新登录 | String |  -   |
|  image  | 200：image_URL<br>208：无            | String |  -   |



接口URL：/api/changeMyInformation

请求方法：PUT

请求参数：

|  字段名   |         说明         |     类型      | 是否必填 |                    备注                     |
| :-------: | :------------------: | :-----------: | :------: | :-----------------------------------------: |
| pbl_token |          -           |    String     |    是    |                用于验证身份                 |
|  content  | json序列化的User对象 |    String     |    是    | 属性有u_id,type, u_name, gender,description |
|   image   |         头像         | MultipartFile |    否    |             无则修改为默认头像              |

返回参数：

| 字段名  | 说明                                 |  类型  | 备注 |
| :-----: | :----------------------------------- | :----: | :--: |
|  code   | 200：修改成功<br>208：登录超时       |  int   |  -   |
| message | 200：无<br>208：登录超时，请重新登录 | String |  -   |
|  image  | 200：image_URL<br>208：无            | String |  -   |
|  token  | 200：新的token                       | String |  -   |



接口URL：/api/changeMyPassword

请求方法：PUT

请求参数：

|  字段名   |         说明         |     类型      | 是否必填 |                    备注                     |
| :-------: | :------------------: | :-----------: | :------: | :-----------------------------------------: |
| pbl_token |          -           |    String     |    是    |                用于验证身份                 |
|  oldPassword  | 原有密码 |    String     |    是    |  |
|  newPassword   |      修改后的密码         | Stringe |    是    |     在后端进行校验旧密码是否正确,正确后进行修改                      |

返回参数：

| 字段名  | 说明                                                         |  类型  | 备注 |
| :-----: | :----------------------------------------------------------- | :----: | :--: |
|  code   | 200：修改成功<br>209:  原密码错误<br>208：登录超时           |  int   |  -   |
| message | 200：新密码的token<br>209：原有密码错误<br>208：登录超时，请重新登录 | String |  -   |




### 课程管理页面

可复用个人信息管理、展示页面的接口/api/searchMyCourses，来搜索老师教的课程或学生选择的课程



接口URL：/api/searchOtherCourses

请求方法：GET

请求参数：

|  字段名   |     说明     |  类型  | 是否必填 |         备注         |
| :-------: | :----------: | :----: | :------: | :------------------: |
| pbl_token |      -       | String |    是    |     用于验证身份     |
| pageIndex | 当前请求页码 | String |    是    |          -           |
| pageSize  | 一页元素数量 | String |    是    | 用于计算返回哪些元素 |

返回参数：

|  字段名  | 说明                                 |  类型  |                             备注                             |
| :------: | :----------------------------------- | :----: | :----------------------------------------------------------: |
|   code   | 200：查询成功<br>208：登录超时       |  int   |                              -                               |
| message  | 200：无<br>208：登录超时，请重新登录 | String |                              -                               |
| courses  | json序列化course数组                 | String | 包含属性c_id,t_id,c_name,point, description, status,image_URL<br>这里包含了其它已发布的课程信息，供学生/老师查看<br>需要对课程按照用户是否可见进行过滤 |
| teachers | json序列化user数组                   | String |          至少包含u_id, image, 再加其它字段也可以的           |
|  total   | 课程对象总数量                       |  int   |                        用于计算总页码                        |

> 期望的结构能做到如下这样，如果不行，把course和teacher并列放也可以。——黄
>
> course: {
>
> ​    c_id: number,
>
> ​    teacher: {
>
> ​		 u_id: number,
>
> ​		type: string, 
>​	
> ​				u_name: string, 
>​	
> ​				gender: string,
>​	
> ​				description: string,
>​	
> ​				image: string, 
>
> ​	}, 
>
> ​    c_name: string, 
>
> ​    t_name: string, 
>
> ​    point: number, 
>
> ​    description: string, 
>
> ​    status: boolean, // 未发布false, 已发布true
>
> ​    c_image_URL: string, // course封面图，没有的话应该返回默认图URL
>
> ​    //t_image_URL: string, // 教师头像，没有的话应该返回默认图URL
>
> }



接口URL：/api/searchAllCourses

请求方法：GET

请求参数：

|  字段名   | 说明 |  类型  | 是否必填 |     备注     |
| :-------: | :--: | :----: | :------: | :----------: |
| pbl_token |  -   | String |    是    | 用于验证身份 |
| pageIndex | 当前请求页码 | String |    是    |          -           |
| pageSize  | 一页元素数量 | String |    是    | 用于计算返回哪些元素 |

返回参数：

| 字段名  | 说明                                 |  类型  |                             备注                             |
| :-----: | :----------------------------------- | :----: | :----------------------------------------------------------: |
|  code   | 200：查询成功<br>208：登录超时       |  int   |                              -                               |
| message | 200：无<br>208：登录超时，请重新登录 | String |                              -                               |
| courses | json序列化course数组                 | String | 包含属性c_id,t_id,c_name,point, description, status,image_URL<br>这里包含了所有课程信息，供管理员查询 |
| teachers | json序列化user数组                   | String |          至少包含u_id, image, 再加其它字段也可以的           |
|  total   | 课程对象总数量                       |  int   |                        用于计算总页码                        |



接口URL：/api/changeCourseStatus

请求方法：PUT

请求参数：

|  字段名   |      说明      |  类型  | 是否必填 |        备注        |
| :-------: | :------------: | :----: | :------: | :----------------: |
| pbl_token |       -        | String |    是    |    用于验证身份    |
|   c_id    |     课程id     | String |    是    |         -          |
|  status   | 课程修改后状态 | String |    是    | 已发布(1)/删除(-1) |

返回参数：

| 字段名  | 说明                                       |  类型  | 备注 |
| :-----: | :----------------------------------------- | :----: | :--: |
|  code   | 200：修改成功<br>208：登录超时             |  int   |  -   |
| message | 200：修改成功<br>208：登录超时，请重新登录 | String |  -   |



接口URL：/api/changeCourse

请求方法：PUT

请求参数：

|  字段名   |        说明        |  类型  | 是否必填 |                             备注                             |
| :-------: | :----------------: | :----: | :------: | :----------------------------------------------------------: |
| pbl_token |         -          | String |    是    |                         用于验证身份                         |
|  course   | json序列化课程对象 | String |    是    | 课程对象可用属性c_id,t_id,c_name,point, description<br/>这里包含了课程修改后相关信息 |

返回参数：

| 字段名  | 说明                                       |  类型  | 备注 |
| :-----: | :----------------------------------------- | :----: | :--: |
|  code   | 200：修改成功<br>208：登录超时             |  int   |  -   |
| message | 200：修改成功<br>208：登录超时，请重新登录 | String |  -   |



接口URL：/api/addCourse

请求方法：POST

请求参数：

|  字段名   |        说明        |     类型      | 是否必填 |                             备注                             |
| :-------: | :----------------: | :-----------: | :------: | :----------------------------------------------------------: |
| pbl_token |         -          |    String     |    是    |                         用于验证身份                         |
|  course   | json序列化课程对象 |    String     |    是    | 课程对象可用属性t_id,c_name,point, description<br/>这里包含了课程创建时收集的相关信息 |
|   image   |    课程封面图像    | MultipartFile |    是    |                              -                               |

返回参数：

|  字段名   | 说明                                           |  类型  | 备注 |
| :-------: | :--------------------------------------------- | :----: | :--: |
|   code    | 200：课程创建成功<br>208：登录超时             |  int   |  -   |
|  message  | 200：课程创建成功<br>208：登录超时，请重新登录 | String |  -   |
|   c_id    | 新建课程id                                     |  int   |  -   |
| image_URL | 新建课程封面图像地址                           | String |  -   |



接口URL：/api/joinCourse

请求方法：POST

请求参数：

|  字段名   |  说明  |  类型  | 是否必填 |     备注     |
| :-------: | :----: | :----: | :------: | :----------: |
| pbl_token |   -    | String |    是    | 用于验证身份 |
|   s_id    | 学生id | String |    是    |      -       |
|   c_id    | 课程id | String |    是    |      -       |

返回参数：

| 字段名  | 说明                                           |  类型  | 备注 |
| :-----: | :--------------------------------------------- | :----: | :--: |
|  code   | 200：成功加入课程<br>208：登录超时             |  int   |  -   |
| message | 200：成功加入课程<br>208：登录超时，请重新登录 | String |  -   |

### 项目管理页面

#### 项目展示页面

接口URL：/api/searchAllMyCourses

请求方法：GET

请求参数：

|  字段名   | 说明 |  类型  | 是否必填 |     备注     |
| :-------: | :--: | :----: | :------: | :----------: |
| pbl_token |  -   | String |    是    | 用于验证身份 |

返回参数：

| 字段名  | 说明                                         |  类型  |                             备注                             |
| :-----: | :------------------------------------------- | :----: | :----------------------------------------------------------: |
|  code   | 200：查询成功<br>208：登录超时               |  int   |                              -                               |
| message | 200：无<br>208：登录超时，请重新登录         | String |                              -                               |
|  type   | 200：用户类型                                | String |                            S/T/A                             |
| courses | json序列化Course数组，但是只需要c_id和c_name | String | [{c_id: number, c_name: string}, {c_id: number, c_name: string}, ...]<br>学生和教师用户需要返回该用户相关的课程，管理员用户需要返回**所有**课程 |



接口URL：/api/searchProject

请求方法：GET

请求参数：

|  字段名   |  说明  |  类型  | 是否必填 |     备注     |
| :-------: | :----: | :----: | :------: | :----------: |
| pbl_token |   -    | String |    是    | 用于验证身份 |
|   c_id    | 课程id | String |    是    |      -       |

返回参数：

|    字段名    | 说明                                            |  类型  |                             备注                             |
| :----------: | :---------------------------------------------- | :----: | :----------------------------------------------------------: |
|     code     | 200：查询成功<br>208：登录超时                  |  int   |                              -                               |
|   message    | 200：无<br>208：登录超时，请重新登录            | String |                              -                               |
|     type     | 200：用户类型                                   | String |                            S/T/A                             |
| project_take | 学生已加入项目：p_id<br>学生未加入项目/其它：-1 |  int   |                              -                               |
|   projects   | json序列化Project数组                           | String | Project对象包含属性p_id,c_id,p_name,description, grading_status, teacher_grade_ratio,self_grade_ratio, mutual_grade_ratio |

> Project {
>
>  p_id: number, 
>
>  c_id: number, 
>
>  p_name: string, 
>
>  description: string, 
>
>  grading_status: boolean, // true 表示已评分，false 未评分
>
>  teacher_grade_ratio: number, 
>
>  self_grade_ratio: number, 
>
>  mutual_grade_ratio: number, 
>
> }




接口URL：/api/createProject

请求方法：POST

请求参数：

|  字段名   |                             说明                             |  类型  | 是否必填 |                             备注                             |
| :-------: | :----------------------------------------------------------: | :----: | :------: | :----------------------------------------------------------: |
| pbl_token |                              -                               | String |    是    |                         用于验证身份                         |
|  project  |                    json序列化Project对象                     | String |    是    | Project对象包含属性p_id,c_id,p_name,description, grading_status, teacher_grade_ratio, self_grade_ratio, mutual_grade_ratio<br>p_id为-1 |
|  grades   | 200：教师评分细则，json序列化GradeSystem对象数组<br/>其它：无 | String |    是    |    GradeSystem对象的属性为：item_id,description,max_grade    |

返回参数：

| 字段名  | 说明                                                        |  类型  | 备注 |
| :-----: | :---------------------------------------------------------- | :----: | :--: |
|  code   | 200：创建成功<br>208：登录超时<br>209：创建失败             |  int   |  -   |
| message | 200：创建成功<br>208：登录超时，请重新登录<br>209：创建失败 | String |  -   |
|  p_id   | 创建成功时新建项目的p_id                                    |  int   |  -   |



接口URL：/api/deleteProject

请求方法：DELETE

请求参数：

|  字段名   |      说明      |  类型  | 是否必填 |     备注     |
| :-------: | :------------: | :----: | :------: | :----------: |
| pbl_token |       -        | String |    是    | 用于验证身份 |
|   p_id    | 要删除的项目id | String |    是    |      -       |

返回参数：

| 字段名  | 说明                                                  |  类型  | 备注 |
| :-----: | :---------------------------------------------------- | :----: | :--: |
|  code   | 200：删除成功<br/>208：登录超时<br/>209：删除失败     |  int   |  -   |
| message | 200：无<br>208：登录超时，请重新登录<br>209：删除失败 | String |  -   |



接口URL：/api/changeProject

请求方法：POST

请求参数：

|  字段名   |                             说明                             |  类型  | 是否必填 |                             备注                             |
| :-------: | :----------------------------------------------------------: | :----: | :------: | :----------------------------------------------------------: |
| pbl_token |                              -                               | String |    是    |                         用于验证身份                         |
|  project  |                    json序列化Project对象                     | String |    是    | Project对象包含属性p_id,c_id,p_name,description, grading_status, teacher_grade_ratio, self_grade_ratio, mutual_grade_ratio |
|  grades   | 200：教师评分细则，json序列化GradeSystem对象数组<br/>其它：无 | String |    是    | GradeSystem对象的属性为：p_id,item_id,description,max_grade  |

返回参数：

| 字段名  | 说明                                              |  类型  | 备注 |
| :-----: | :------------------------------------------------ | :----: | :--: |
|  code   | 200：修改成功<br/>208：登录超时<br/>209：修改失败 |  int   |  -   |
| message | 200：无<br>208：登录超时，请重新登录<br>209：失败 | String |  -   |



接口URL：/api/joinProject

请求方法：POST

请求参数：

|  字段名   |  说明  |  类型  | 是否必填 |     备注     |
| :-------: | :----: | :----: | :------: | :----------: |
| pbl_token |   -    | String |    是    | 用于验证身份 |
|   p_id    | 项目id | String |    是    |      -       |

返回参数：

| 字段名  | 说明                                 |  类型  | 备注 |
| :-----: | :----------------------------------- | :----: | :--: |
|  code   | 200：加入成功<br/>208：登录超时      |  int   |  -   |
| message | 200：无<br>208：登录超时，请重新登录 | String |  -   |



接口URL：/api/searchProjectGradeSystem

请求方法：GET

请求参数：

|  字段名   |  说明  |  类型  | 是否必填 |     备注     |
| :-------: | :----: | :----: | :------: | :----------: |
| pbl_token |   -    | String |    是    | 用于验证身份 |
|   p_id    | 项目id | String |    是    |      -       |

返回参数：

| 字段名  | 说明                                                   |  类型  |                             备注                             |
| :-----: | :----------------------------------------------------- | :----: | :----------------------------------------------------------: |
|  code   | 200：查询成功<br>208：登录超时                         |  int   |                              -                               |
| message | 200：无<br>208：登录超时，请重新登录                   | String |                              -                               |
| grades  | 200：教师评分细则，json序列化grade对象数组<br/>208：无 | String | grade对象的可用属性为：item_id,description,i_grade,max_grade<br/>这里i_grade(学生得分)可不填 |



#### 项目详情页面

##### 任务页面



接口URL：/api/searchAssignment

请求方法：GET

请求参数：

|  字段名   |  说明  |  类型  | 是否必填 |     备注     |
| :-------: | :----: | :----: | :------: | :----------: |
| pbl_token |   -    | String |    是    | 用于验证身份 |
|   p_id    | 项目id | String |    是    |      -       |

返回参数：

|    字段名     | 说明                                                      |  类型  |                             备注                             |
| :-----------: | :-------------------------------------------------------- | :----: | :----------------------------------------------------------: |
|     code      | 200：查询成功<br/>208：登录超时<br/>209：查询失败         |  int   |                              -                               |
|    message    | 200：查询成功<br>208：登录超时请重新登录<br>209：查询失败 | String |                              -                               |
|  assignments  | 200：json序列化Assignment数组(按照a_id排序)<br>其它：无   | String | assignment类型包含属性：a_id,a_name,a_description,<br>importance,a_start_date,a_end_date |
| studentStatus | 200：json序列化boolean数组(按照a_id排序)<br>其它：无      | String |      对应上面学生的完成状态：完成-true<br>未完成-false       |
|  urgeStatus   | 200：学生每个任务的urge情况(按照a_id排序)                 | String |      对应上面学生的urge状态：完成-true<br/>未完成-false      |
|    doneNum    | 200：每个任务的学生完成人数(按照a_id排序)                 | String |                              -                               |
|   totalNum    | 200：项目总人数                                           |  int   |                              -                               |

> 还需要student_assignment里的urge信息和分配给的学生的id和name，可以研究一下怎么样的形式返回来比较好



接口URL：/api/searchAssignmentDone

请求方法：GET

请求参数：

|  字段名   |  说明  |  类型  | 是否必填 |     备注     |
| :-------: | :----: | :----: | :------: | :----------: |
| pbl_token |   -    | String |    是    | 用于验证身份 |
|   p_id    | 项目id | String |    是    |      -       |
|   a_id    | 任务id | String |    是    |      -       |

返回参数：

|   字段名    | 说明                                                        |  类型  | 备注 |
| :---------: | :---------------------------------------------------------- | :----: | :--: |
|    code     | 200：查询成功<br/>208：登录超时<br/>209：查询失败           |  int   |  -   |
|   message   | 200：查询成功<br>208：登录超时，请重新登录<br>209：查询失败 | String |  -   |
| assignments | 200：完成该任务的总人数<br>其它：无                         |  int   |  -   |
|  totalNum   | 200：项目总人数<br>其它：无                                 |  int   |  -   |



接口URL：/api/createAssignment

请求方法：POST

请求参数：

|   字段名   |           说明           |  类型  | 是否必填 |                             备注                             |
| :--------: | :----------------------: | :----: | :------: | :----------------------------------------------------------: |
| pbl_token  |            -             | String |    是    |                         用于验证身份                         |
| assignment | json序列化assignment对象 | String |    是    | assignment对象包含属性：a_id,a_name,a_description,<br/>importance,a_start_date,a_end_date<br>其中a_id为-1 |

返回参数：

| 字段名  | 说明                                                         |  类型  | 备注 |
| :-----: | :----------------------------------------------------------- | :----: | :--: |
|  code   | 200：创建任务成功<br/>208：登录超时<br/>209：创建任务失败    |  int   |  -   |
| message | 200：创建任务成功<br>208：登录超时，请重新登录<br>209：修改任务失败 | String |  -   |
|  a_id   | 200：新建任务id<br/>208：无<br/>209：无                      |  int   |  -   |



接口URL：/api/createAssignment

请求方法：POST

请求参数：

|   字段名    |             说明             |  类型  | 是否必填 |                             备注                             |
| :---------: | :--------------------------: | :----: | :------: | :----------------------------------------------------------: |
|  pbl_token  |              -               | String |    是    |                         用于验证身份                         |
| assignments | json序列化assignment对象列表 | String |    是    | assignment对象包含属性：a_id,a_name,a_description,<br/>importance,a_start_date,a_end_date<br>其中a_id为-1 |

返回参数：

|  字段名  | 说明                                                         |  类型  | 备注 |
| :------: | :----------------------------------------------------------- | :----: | :--: |
|   code   | 200：批量创建任务成功<br/>208：登录超时<br/>209：批量创建任务失败 |  int   |  -   |
| message  | 200：批量创建任务成功<br>208：登录超时，请重新登录<br>209：批量创建任务成功 | String |  -   |
| a_idList | 200：新建任务列表id<br/>208：无<br/>209：无                  |  int   |  -   |



接口URL：/api/changeAssignment

请求方法：PUT

请求参数：

|   字段名   |           说明           |  类型  | 是否必填 |                             备注                             |
| :--------: | :----------------------: | :----: | :------: | :----------------------------------------------------------: |
| pbl_token  |            -             | String |    是    |                         用于验证身份                         |
| assignment | json序列化assignment对象 | String |    是    | assignment对象包含属性：a_id,a_name,a_description,<br/>importance,a_start_date,a_end_date |

返回参数：

| 字段名  | 说明                                                        |  类型  | 备注 |
| :-----: | :---------------------------------------------------------- | :----: | :--: |
|  code   | 200：修改成功<br/>208：登录超时<br/>209：修改失败           |  int   |  -   |
| message | 200：修改成功<br>208：登录超时，请重新登录<br>209：修改失败 | String |  -   |



接口URL：/api/changeAssignments

请求方法：PUT

请求参数：

|   字段名    |             说明             |  类型  | 是否必填 |                             备注                             |
| :---------: | :--------------------------: | :----: | :------: | :----------------------------------------------------------: |
|  pbl_token  |              -               | String |    是    |                         用于验证身份                         |
| assignments | json序列化assignment对象列表 | String |    是    | assignment对象包含属性：a_id,a_name,a_description,<br/>importance,a_start_date,a_end_date |

返回参数：

| 字段名  | 说明                                                         |  类型  | 备注 |
| :-----: | :----------------------------------------------------------- | :----: | :--: |
|  code   | 200：批量修改任务成功<br/>208：登录超时<br/>209：批量修改任务失败 |  int   |  -   |
| message | 200：批量修改任务成功<br>208：登录超时，请重新登录<br>209：批量修改任务失败 | String |  -   |



接口URL：/api/deleteAssignment

请求方法：DELETE

请求参数：

|  字段名   |     说明      |  类型  | 是否必填 |     备注     |
| :-------: | :-----------: | :----: | :------: | :----------: |
| pbl_token |       -       | String |    是    | 用于验证身份 |
|   a_id    | assignment id | String |    是    |      -       |
|   p_id    |  project id   | String |    是    |      -       |

返回参数：

| 字段名  | 说明                                                         |  类型  | 备注 |
| :-----: | :----------------------------------------------------------- | :----: | :--: |
|  code   | 200：删除成功<br/>208：登录超时<br/>209：删除失败            |  int   |  -   |
| message | 200：删除成功<br/>208：登录超时，请重新登录<br/>209：删除失败 | String |  -   |



接口URL：/api/deleteAssignment

请求方法：DELETE

请求参数：

|  字段名   |        说明        |  类型  | 是否必填 |     备注     |
| :-------: | :----------------: | :----: | :------: | :----------: |
| pbl_token |         -          | String |    是    | 用于验证身份 |
| a_idList  | assignment id 列表 | String |    是    |      -       |
|   p_id    |     project id     | String |    是    |      -       |

返回参数：

| 字段名  | 说明                                                         |  类型  | 备注 |
| :-----: | :----------------------------------------------------------- | :----: | :--: |
|  code   | 200：批量删除任务成功<br/>208：登录超时<br/>209：批量删除任务失败 |  int   |  -   |
| message | 200：批量删除任务成功<br/>208：登录超时，请重新登录<br/>209：批量删除任务失败 | String |  -   |



接口URL：/api/urgeAssignment

请求方法：PUT

请求参数：

|  字段名   |     说明      |  类型  | 是否必填 |     备注     |
| :-------: | :-----------: | :----: | :------: | :----------: |
| pbl_token |       -       | String |    是    | 用于验证身份 |
|   a_id    | assignment id |  int   |    是    |      -       |
|   p_id    |  project id   |  int   |    是    |      -       |

返回参数：

| 字段名  | 说明                                                         |  类型  | 备注 |
| :-----: | :----------------------------------------------------------- | :----: | :--: |
|  code   | 200：催促消息发送成功<br/>208：登录超时<br/>209：催促消息发送失败 |  int   |  -   |
| message | 200：催促消息发送成功<br/>208：登录超时，请重新登录<br/>209：催促消息发送失败 | String |  -   |



接口URL：/api/applyUrge

请求方法：PUT

请求参数：

|  字段名   |     说明      |  类型  | 是否必填 |     备注     |
| :-------: | :-----------: | :----: | :------: | :----------: |
| pbl_token |       -       | String |    是    | 用于验证身份 |
|   a_id    | assignment id | String |    是    |      -       |
|   p_id    |  project id   | String |    是    |      -       |

返回参数：

| 字段名  | 说明                                                |  类型  | 备注 |
| :-----: | :-------------------------------------------------- | :----: | :--: |
|  code   | 200：成功回应催促消息<br/>208：登录超时             |  int   |  -   |
| message | 200：成功回应催促消息<br/>208：登录超时，请重新登录 | String |  -   |



接口URL：/api/countDone

请求方法：GET

请求参数：

|  字段名   |    说明    |  类型  | 是否必填 |     备注     |
| :-------: | :--------: | :----: | :------: | :----------: |
| pbl_token |     -      | String |    是    | 用于验证身份 |
|   p_id    | project id | String |    是    |      -       |

返回参数：

|  字段名   | 说明                                                         |  类型  | 备注 |
| :-------: | :----------------------------------------------------------- | :----: | :--: |
|   code    | 200：成功统计项目完成人数<br/>208：登录超时<br/>209：未能统计项目完成人数 |  int   |  -   |
|  message  | 200：成功统计项目完成人数<br/>208：登录超时，请重新登录<br/>209：未能统计项目完成人数 | String |  -   |
| done_num  | 200：项目完成人数(所有assignment完成的人)<br>其它：-1        |  int   |  -   |
| total_num | 200：项目总人数<br>其它：-1                                  |  int   |  -   |



##### 成员页面



接口URL：/api/searchGroupers

请求方法：GET

请求参数：

|  字段名   |    说明    |  类型  | 是否必填 |     备注     |
| :-------: | :--------: | :----: | :------: | :----------: |
| pbl_token |     -      | String |    是    | 用于验证身份 |
|   p_id    | project id | String |    是    |      -       |

返回参数：

|  字段名  | 说明                                  |  类型  |                 备注                  |
| :------: | :------------------------------------ | :----: | :-----------------------------------: |
|   code   | 200：搜索成功<br/>208：登录超时       |  int   |                   -                   |
| message  | 200：无<br/>208：登录超时，请重新登录 | String |                   -                   |
| groupers | 200：json序列化User对象数组           | String | User对象中可用属性为：<br>u_id,u_name |
|  leader  | 200：组长s_id                         | String |                   -                   |

User {

  u_id: number,

  type: string, 

  u_name: string, 

  gender: string,

  description: string,

  image: string, 

}

这里可以复用上面/api/searchProjectGradeSystem，获得该项目的评分方式，再展示相应的接口



接口URL：/api/searchEvaluateBySelf

请求方法：GET

请求参数：

|  字段名   |  说明  |  类型  | 是否必填 |     备注     |
| :-------: | :----: | :----: | :------: | :----------: |
| pbl_token |   -    | String |    是    | 用于验证身份 |
|   p_id    | 项目id | String |    是    |      -       |

返回参数：

| 字段名  | 说明                                                   |  类型  | 备注 |
| :-----: | :----------------------------------------------------- | :----: | :--: |
|  code   | 200：无<br/>208：登录超时<br>209：暂未评分             |  int   |  -   |
| message | 200：无<br/>208：登录超时，请重新登录<br>209：暂未评分 | String |  -   |
|  grade  | 200：自评评分<br>其它：-1                              | double |  -   |



接口URL：/api/evaluateSelf

请求方法：POST

请求参数：

|  字段名   |  说明  |  类型  | 是否必填 |      备注       |
| :-------: | :----: | :----: | :------: | :-------------: |
| pbl_token |   -    | String |    是    |  用于验证身份   |
|   p_id    | 项目id | String |    是    |        -        |
|   grade   |   -    | String |    是    | 0-100之间的数字 |

返回参数：

| 字段名  | 说明                                        |  类型  | 备注 |
| :-----: | :------------------------------------------ | :----: | :--: |
|  code   | 200：评价成功<br/>208：登录超时             |  int   |  -   |
| message | 200：评价成功<br/>208：登录超时，请重新登录 | String |  -   |



接口URL：/api/searchEvaluateByOther

请求方法：GET

请求参数：

|  字段名   |  说明  |  类型  | 是否必填 |     备注     |
| :-------: | :----: | :----: | :------: | :----------: |
| pbl_token |   -    | String |    是    | 用于验证身份 |
|   p_id    | 项目id | String |    是    |      -       |

返回参数：

|  字段名  | 说明                                                   |  类型  | 备注 |
| :------: | :----------------------------------------------------- | :----: | :--: |
|   code   | 200：无<br/>208：登录超时<br>209：暂未评分             |  int   |  -   |
| message  | 200：无<br/>208：登录超时，请重新登录<br>209：暂未评分 | String |  -   |
|  grade   | 200：互评的平均评分<br>208：-1<br>209：-1              | double |  -   |
| doneNum  | 200：已评分人数<br>208：-1<br>209：0                   |  int   |  -   |
| totalNum | 200：项目总人数<br>208：-1<br>209：项目总人数          |  int   |  -   |



接口URL：/api/evaluateOther

请求方法：POST

请求参数：

|  字段名   |      说明      |  类型  | 是否必填 |         备注          |
| :-------: | :------------: | :----: | :------: | :-------------------: |
| pbl_token |       -        | String |    是    |     用于验证身份      |
|   p_id    |     项目id     | String |    是    |           -           |
|   u_id    | 被评分用户的id | String |    是    |           -           |
|   grade   |       -        | String |    是    | 0-100之间的double小数 |

返回参数：

| 字段名  | 说明                                        |  类型  | 备注 |
| :-----: | :------------------------------------------ | :----: | :--: |
|  code   | 200：评价成功<br/>208：登录超时             |  int   |  -   |
| message | 200：评价成功<br/>208：登录超时，请重新登录 | String |  -   |



接口URL：/api/searchEvaluateByTeacher

请求方法：GET

请求参数：

|  字段名   |  说明  |  类型  | 是否必填 |     备注     |
| :-------: | :----: | :----: | :------: | :----------: |
| pbl_token |   -    | String |    是    | 用于验证身份 |
|   p_id    | 项目id | String |    是    |      -       |

返回参数：

| 字段名  | 说明                                                     |  类型  |                           备注                           |
| :-----: | :------------------------------------------------------- | :----: | :------------------------------------------------------: |
|  code   | 200：无<br/>208：登录超时<br>209：教师未评分             |  int   |                            -                             |
| message | 200：无<br/>208：登录超时，请重新登录<br>209：教师未评分 | String |                            -                             |
| grades  | 200：教师评分细则，json序列化grade对象数组<br>其它：无   | String | grade对象的属性为：item_id,description,i_grade,max_grade |



接口URL：/api/searchGrade

请求方法：GET

请求参数：

|  字段名   |  说明  |  类型  | 是否必填 |     备注     |
| :-------: | :----: | :----: | :------: | :----------: |
| pbl_token |   -    | String |    是    | 用于验证身份 |
|   p_id    | 项目id | String |    是    |      -       |

返回参数：

| 字段名  | 说明                                                         |  类型  | 备注 |
| :-----: | :----------------------------------------------------------- | :----: | :--: |
|  code   | 200：无<br/>208：登录超时<br>209：未生成最终评分             |  int   |  -   |
| message | 200：无<br/>208：登录超时，请重新登录<br>209：未生成最终评分 | String |  -   |
|  grade  | 200：最终评分<br>其它：-1                                    | double |  -   |



##### 讨论版页面

接口URL：/api/searchDiscussions

请求方法：GET

请求参数：

|  字段名   |  说明  |  类型  | 是否必填 |     备注     |
| :-------: | :----: | :----: | :------: | :----------: |
| pbl_token |   -    | String |    是    | 用于验证身份 |
|   p_id    | 项目id | String |    是    |      -       |

返回参数：

|   字段名    | 说明                                                     |  类型  |                        备注                         |
| :---------: | :------------------------------------------------------- | :----: | :-------------------------------------------------: |
|    code     | 200：无<br/>208：登录超时                                |  int   |                          -                          |
|   message   | 200：无<br/>208：登录超时，请重新登录                    | String |                          -                          |
| discussions | 200：json序列化discussion数组(由时间远近排列)<br>208：无 | String | discussion对象包含属性：d_id,p_id,u_id,content,time |



接口URL：/api/createDiscussion

请求方法：POST

请求参数：

|   字段名   |            说明            |  类型  | 是否必填 |                             备注                             |
| :--------: | :------------------------: | :----: | :------: | :----------------------------------------------------------: |
| pbl_token  |             -              | String |    是    |                         用于验证身份                         |
| discussion | json序列化的discussion对象 | String |    是    | discussion对象包含属性：d_id,p_id,u_id,content,time<br>其中d_id=-1 |

返回参数：

| 字段名  | 说明                                        |  类型  | 备注 |
| :-----: | :------------------------------------------ | :----: | :--: |
|  code   | 200：发布成功<br/>208：登录超时             |  int   |  -   |
| message | 200：发布成功<br/>208：登录超时，请重新登录 | String |  -   |
|  d_id   | 200：新创建的discussion id<br>208：-1       |  int   |  -   |



接口URL：/api/deleteDiscussion

请求方法：DELETE

请求参数：

|  字段名   |  说明  |  类型  | 是否必填 |     备注     |
| :-------: | :----: | :----: | :------: | :----------: |
| pbl_token |   -    | String |    是    | 用于验证身份 |
|   d_id    | 讨论id | String |    是    |      -       |
|   p_id    | 项目id | String |    是    |      -       |

返回参数：

| 字段名  | 说明                                                         |  类型  | 备注 |
| :-----: | :----------------------------------------------------------- | :----: | :--: |
|  code   | 200：删除成功<br/>208：登录超时<br>209：删除失败             |  int   |  -   |
| message | 200：删除成功<br/>208：登录超时，请重新登录<br>209：删除失败 | String |  -   |



接口URL：/api/searchReply

请求方法：GET

请求参数：

|  字段名   |  说明  |  类型  | 是否必填 |     备注     |
| :-------: | :----: | :----: | :------: | :----------: |
| pbl_token |   -    | String |    是    | 用于验证身份 |
|   d_id    | 讨论id | String |    是    |      -       |

返回参数：

| 字段名  | 说明                                                    |  类型  |                      备注                      |
| :-----: | :------------------------------------------------------ | :----: | :--------------------------------------------: |
|  code   | 200：无<br/>208：登录超时                               |  int   |                       -                        |
| message | 200：无<br/>208：登录超时，请重新登录                   | String |                       -                        |
| replies | 200：json序列化reply对象数组(由时间远近排列)<br>208：无 | String | reply对象包含属性：r_id,d_id,u_id,content,time |



接口URL：/api/createReply

请求方法：POST

请求参数：

|  字段名   |         说明          |  类型  | 是否必填 |                             备注                             |
| :-------: | :-------------------: | :----: | :------: | :----------------------------------------------------------: |
| pbl_token |           -           | String |    是    |                         用于验证身份                         |
| reply对象 | json序列化的reply对象 | String |    是    | reply对象包含属性：r_id,d_id,u_id,content,time<br>其中r_id=-1 |

返回参数：

| 字段名  | 说明                                        |  类型  | 备注 |
| :-----: | :------------------------------------------ | :----: | :--: |
|  code   | 200：发布成功<br/>208：登录超时             |  int   |  -   |
| message | 200：发布成功<br/>208：登录超时，请重新登录 | String |  -   |
|  r_id   | 200：新创建的reply id<br>208：-1            |  int   |  -   |



接口URL：/api/deleteReply

请求方法：DELETE

请求参数：

|  字段名   |   说明   |  类型  | 是否必填 |     备注     |
| :-------: | :------: | :----: | :------: | :----------: |
| pbl_token |    -     | String |    是    | 用于验证身份 |
|   r_id    | 回复帖id |  int   |    是    |      -       |
|   p_id    |  项目id  |  int   |    是    |      -       |

返回参数：

| 字段名  | 说明                                                         |  类型  | 备注 |
| :-----: | :----------------------------------------------------------- | :----: | :--: |
|  code   | 200：删除成功<br/>208：登录超时<br>209：删除失败             |  int   |  -   |
| message | 200：删除成功<br/>208：登录超时，请重新登录<br>209：删除失败 | String |  -   |



##### 文件管理空间页面

接口URL：/api/searchAllFiles

请求方法：GET

请求参数：

|  字段名   |  说明  |  类型  | 是否必填 |     备注     |
| :-------: | :----: | :----: | :------: | :----------: |
| pbl_token |   -    | String |    是    | 用于验证身份 |
|   p_id    | 项目id | String |    是    |      -       |

返回参数：

| 字段名  | 说明                                                         |  类型  |                             备注                             |
| :-----: | :----------------------------------------------------------- | :----: | :----------------------------------------------------------: |
|  code   | 200：上传成功<br/>208：登录超时<br>209：上传失败             |  int   |                              -                               |
| message | 200：上传成功<br/>208：登录超时，请重新登录<br>209：文件上传失败 | String |                              -                               |
|  files  | 200：json序列化file对象数组<br>208：null<br>209：null        | String | file对象属性包含：<br>f_id,p_id,u_id,f_name,description,file_URL |

> File {
>
>  f_id: number, 
>
>  p_id: number, 
>
>  u_id: number, 
>
>  f_name: string, 
>
>  description: string, 
>
>  file_URL: string, 
>
> }

接口URL：/api/uploadFile

请求方法：POST

请求参数：

|   字段名    |     说明     |     类型      | 是否必填 |     备注     |
| :---------: | :----------: | :-----------: | :------: | :----------: |
|  pbl_token  |      -       |    String     |    是    | 用于验证身份 |
|   f_name    |    文件名    |    String     |    是    |      -       |
|    p_id     |    项目id    |    String     |    是    |      -       |
|    file     | 要上传的文件 | MultipartFile |    是    |      -       |
| description |   文件描述   |    String     |    是    |      -       |

返回参数：

| 字段名  | 说明                                                         |  类型  |                             备注                             |
| :-----: | :----------------------------------------------------------- | :----: | :----------------------------------------------------------: |
|  code   | 200：上传成功<br/>208：登录超时<br>209：上传失败             |  int   |                              -                               |
| message | 200：上传成功<br/>208：登录超时，请重新登录<br>209：文件上传失败 | String |                              -                               |
|  file   | 200：json序列化file对象<br>208：null<br>209：null            | String | file对象属性包含：<br>f_id,p_id,u_id,f_name,description,file_URL |



接口URL：/api/deleteFile

请求方法：DELETE

请求参数：

|  字段名   |  说明  |  类型  | 是否必填 |     备注     |
| :-------: | :----: | :----: | :------: | :----------: |
| pbl_token |   -    | String |    是    | 用于验证身份 |
|   f_id    | 文件id | String |    是    |      -       |
|   p_id    | 项目id | String |    是    |      -       |

返回参数：

| 字段名  | 说明                                                         |  类型  | 备注 |
| :-----: | :----------------------------------------------------------- | :----: | :--: |
|  code   | 200：删除成功<br/>208：登录超时<br>209：删除失败             |  int   |  -   |
| message | 200：删除成功<br/>208：登录超时，请重新登录<br>209：删除失败 | String |  -   |



接口URL：/api/downloadFile

请求方法：GET

请求参数：

|  字段名   |  说明  |  类型  | 是否必填 |     备注     |
| :-------: | :----: | :----: | :------: | :----------: |
| pbl_token |   -    | String |    是    | 用于验证身份 |
|   f_id    | 文件id | String |    是    |      -       |
|   p_id    | 项目id | String |    是    |      -       |



返回参数：

|  字段名  | 说明                        |  类型  |                             备注                             |
| :------: | :-------------------------- | :----: | :----------------------------------------------------------: |
|   code   | 200：成功<br/>208：登录超时 |  int   |                              -                               |
| message  |                             | String |                              -                               |
| file_str | 读取文件获得的字符串        | String | 预想的下载前端实现，供参考：https://www.jianshu.com/p/05bb4127b098 |




### 评分页面

这里可以复用项目展示页面的接口：/api/searchProject，获得本课程下所有的项目



接口URL：/api/countAssignmentDone

请求方法：GET

请求参数：

|  字段名   |  说明  |  类型  | 是否必填 |     备注     |
| :-------: | :----: | :----: | :------: | :----------: |
| pbl_token |   -    | String |    是    | 用于验证身份 |
|   p_id    | 项目id | String |    是    |      -       |

返回参数：

|       字段名       | 说明                                                      |  类型  |                        备注                        |
| :----------------: | :-------------------------------------------------------- | :----: | :------------------------------------------------: |
|        code        | 200：查询成功<br/>208：登录超时<br/>209：查询失败         |  int   |                         -                          |
|      message       | 200：查询成功<br>208：登录超时请重新登录<br>209：查询失败 | String |                         -                          |
| totalAssignmentNum | 200：项目总任务数<br>其它：-1                             |  int   |                         -                          |
|  doneInformations  | 200：json序列化的学生完成情况数组<br>其它：无             | String | DoneInformation对象包含属性<br>s_id,s_name,doneNum |



接口URL：/api/countDiscussion

请求方法：GET

请求参数：

|  字段名   |  说明  |  类型  | 是否必填 |     备注     |
| :-------: | :----: | :----: | :------: | :----------: |
| pbl_token |   -    | String |    是    | 用于验证身份 |
|   p_id    | 项目id | String |    是    |      -       |

返回参数：

|       字段名        | 说明                                                      |  类型  |                           备注                           |
| :-----------------: | :-------------------------------------------------------- | :----: | :------------------------------------------------------: |
|        code         | 200：查询成功<br/>208：登录超时<br/>209：查询失败         |  int   |                            -                             |
|       message       | 200：查询成功<br>208：登录超时请重新登录<br>209：查询失败 | String |                            -                             |
|    maxDiscussNum    | 200：最大讨论数<br>其它：-1                               |  int   |                            -                             |
| discussInformations | 200：json序列化的学生讨论情况数组<br>其它：无             | String | DiscussInformation对象包含属性<br>s_id,s_name,discussNum |



接口URL：/api/getGradeItems

请求方法：GET

请求参数：

|  字段名   |  说明  |  类型  | 是否必填 |     备注     |
| :-------: | :----: | :----: | :------: | :----------: |
| pbl_token |   -    | String |    是    | 用于验证身份 |
|   p_id    | 项目id | String |    是    |      -       |

返回参数：

| 字段名  | 说明                                                      |  类型  |                          备注                          |
| :-----: | :-------------------------------------------------------- | :----: | :----------------------------------------------------: |
|  code   | 200：查询成功<br/>208：登录超时<br/>209：查询失败         |  int   |                           -                            |
| message | 200：查询成功<br>208：登录超时请重新登录<br>209：查询失败 | String |                           -                            |
| grades  | 200：json序列化GradeSystem对象<br>其它：null              | String | GradeSystem对象的属性为：item_id,description,max_grade |



接口URL：/api/evaluateByTeacher

请求方法：POST

请求参数：

|  字段名   |              说明              |  类型  | 是否必填 |                             备注                             |
| :-------: | :----------------------------: | :----: | :------: | :----------------------------------------------------------: |
| pbl_token |               -                | String |    是    |                         用于验证身份                         |
|   p_id    |             项目id             | String |    是    |                              -                               |
|   s_id    |             学生id             | String |    是    |                              -                               |
|  grades   | json序列化StudentGrade对象数组 | String |    是    | StudentGrade对象的属性为：item_id,p_id,s_id,description,grade<br>这里的description可以不填 |

返回参数：

| 字段名  | 说明                                                         |  类型  | 备注 |
| :-----: | :----------------------------------------------------------- | :----: | :--: |
|  code   | 200：评分成功<br/>208：登录超时<br>209：评分失败             |  int   |  -   |
| message | 200：评分成功<br/>208：登录超时，请重新登录<br>209：评分失败 | String |  -   |

### 用户管理页面

接口URL：/api/searchAllUsers

请求方法：GET

请求参数：

|  字段名   | 说明 |  类型  | 是否必填 |     备注     |
| :-------: | :--: | :----: | :------: | :----------: |
| pbl_token |  -   | String |    是    | 用于验证身份 |

返回参数：

| 字段名  | 说明                                                         |  类型  |                      备注                       |
| :-----: | :----------------------------------------------------------- | :----: | :---------------------------------------------: |
|  code   | 200：查询成功<br>208：登录超时                               |  int   |                        -                        |
| message | 200：查询成功<br>208：登录超时，请重新登录                   | String |                        -                        |
|  users  | json序列化的User对象数组                                     | String | User属性有u_id,type, u_name, gender,description |
| images  | 200时：json序列化图像url数组，顺序与用户数组一致<br>208时：空字符串 | String |                        -                        |



接口URL：/api/changeImage

请求方法：PUT

请求参数：

|  字段名   |  说明  |     类型      | 是否必填 |        备注        |
| :-------: | :----: | :-----------: | :------: | :----------------: |
| pbl_token |   -    |    String     |    是    |    用于验证身份    |
|   u_id    | 学工号 |    String     |    是    |         -          |
|   image   |  头像  | MultipartFile |    否    | 无则修改为默认头像 |

返回参数：

| 字段名  | 说明                                 |  类型  | 备注 |
| :-----: | :----------------------------------- | :----: | :--: |
|  code   | 200：修改成功<br>208：登录超时       |  int   |  -   |
| message | 200：无<br>208：登录超时，请重新登录 | String |  -   |
|  image  | 200：image_URL<br>208：无            | String |  -   |



接口URL：/api/changeInformation

请求方法：PUT

请求参数：

|  字段名   |         说明         |  类型  | 是否必填 |                    备注                     |
| :-------: | :------------------: | :----: | :------: | :-----------------------------------------: |
| pbl_token |          -           | String |    是    |                用于验证身份                 |
|  content  | json序列化的User对象 | String |    是    | 属性有u_id,type, u_name, gender,description |

返回参数：

| 字段名  | 说明                                       |  类型  | 备注 |
| :-----: | :----------------------------------------- | :----: | :--: |
|  code   | 200：修改成功<br>208：登录超时             |  int   |  -   |
| message | 200：修改成功<br>208：登录超时，请重新登录 | String |  -   |



接口URL：/api/addUser

请求方法：POST

请求参数：

|  字段名   |       说明       |     类型      | 是否必填 |                           备注                           |
| :-------: | :--------------: | :-----------: | :------: | :------------------------------------------------------: |
| pbl_token |        -         |    String     |    是    |                       用于验证身份                       |
|   user    | json序列化的User |    String     |    是    | User属性有u_id,type, u_name, gender,description,password |
|   image   |       头像       | MultipartFile |    否    |                    没有则生成默认头像                    |

返回参数：

| 字段名  | 说明                                                |  类型  | 备注 |
| :-----: | :-------------------------------------------------- | :----: | :--: |
|  code   | 200：添加成功<br>208：登录超时<br>209：用户名已存在 |  int   |  -   |
| message | 200：添加成功<br>其它：返回错误信息                 | String |  -   |
|  image  | 200：携带图像url<br>其它：空字符串                  | String |  -   |
